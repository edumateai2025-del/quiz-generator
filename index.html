<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>EduMateAI Quiz</title>
<link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap" rel="stylesheet">
<style>
  * { margin:0; padding:0; box-sizing:border-box; font-family:'Roboto', sans-serif; }
  html, body { height:100%; overflow:hidden; }

  /* Live gradient background loved universally */
  body {
    background: linear-gradient(-45deg, #1e3c72, #2a5298, #6dd5fa, #2980b9);
    background-size: 400% 400%;
    animation: gradientBG 15s ease infinite;
    color:#fff;
    display:flex;
    flex-direction:column;
    justify-content:center;
    align-items:center;
  }

  @keyframes gradientBG {
    0% { background-position:0% 50%; }
    50% { background-position:100% 50%; }
    100% { background-position:0% 50%; }
  }

  .container { text-align:center; flex:1; display:flex; flex-direction:column; justify-content:center; align-items:center; width:100%; }
  h1 { font-size:2rem; min-height:50px; margin-bottom:20px; white-space:pre; }

  .start-button {
    position:fixed; bottom:40px; left:50%; transform:translateX(-50%);
    background:#10b981; color:#fff; padding:16px 32px; border:none; border-radius:12px;
    font-size:1.2rem; cursor:pointer; font-weight:700; box-shadow:0 4px 15px rgba(0,0,0,0.4);
    transition: all 0.3s ease;
  }
  .start-button:hover { transform:translateX(-50%) scale(1.05); }

  /* Quiz Section */
  #quizSection { display:none; text-align:center; width:100%; max-width:600px; padding:20px; }
  h2 { margin-bottom:20px; }
  ul.options { list-style:none; padding:0; }
  ul.options li {
    background:rgba(0,0,0,0.4); margin:10px 0; padding:15px; border-radius:10px; cursor:pointer;
    transition: all 0.3s ease;
  }
  ul.options li:hover { background:#28a745; transform:scale(1.02); }
  #scoreContainer { display:none; margin-top:20px; }
</style>
</head>
<body>

<div class="container" id="landing">
  <h1 id="liveText"></h1>
</div>

<button class="start-button" id="startQuizBtn">Start Quiz</button>

<div id="quizSection">
  <h2 id="question">Question Text</h2>
  <ul class="options" id="options"></ul>
  <div id="scoreContainer">
    <h2>Your Score: <span id="score">0</span> / <span id="total"></span></h2>
    <button class="start-button" id="playAgainBtn">Play Again</button>
  </div>
</div>

<script>
// ==== Live Typing ====
const messages = ["Test Your Knowledge!","Ready for the Challenge?","Learn, Practice, Excel!","20 Questions Await You!","Start Your Quiz Adventure!"];
let msgIndex=0, charIndex=0, deleting=false;
function typeEffect(){
  const el=document.getElementById('liveText');
  if(!deleting){
    el.textContent=messages[msgIndex].slice(0,charIndex++);
    if(charIndex>messages[msgIndex].length){ deleting=true; setTimeout(typeEffect,1000); return; }
  } else {
    el.textContent=messages[msgIndex].slice(0,charIndex--);
    if(charIndex<0){ deleting=false; msgIndex=(msgIndex+1)%messages.length; }
  }
  setTimeout(typeEffect,deleting?50:120);
}
typeEffect();

// ==== Quiz Logic ====
let questions=[], currentQuestion=0, score=0;
const landing = document.getElementById('landing');
const quizSection = document.getElementById('quizSection');
const questionEl = document.getElementById('question');
const optionsEl = document.getElementById('options');
const scoreContainer = document.getElementById('scoreContainer');
const scoreEl = document.getElementById('score');
const totalEl = document.getElementById('total');
const startQuizBtn = document.getElementById('startQuizBtn');
const playAgainBtn = document.getElementById('playAgainBtn');

startQuizBtn.onclick = async () => {
  landing.style.display = 'none';
  startQuizBtn.style.display = 'none';
  quizSection.style.display = 'block';
  await loadQuestions();
  loadQuestion();
};

async function loadQuestions(){
  try{
    const res = await fetch('/api/getQuestions');
    const data = await res.json();
    questions = data.sort(() => Math.random()-0.5);
  } catch(err){ alert("Error loading questions!"); console.error(err);}
}

function loadQuestion(){
  const q = questions[currentQuestion];
  questionEl.textContent = q.q;
  optionsEl.innerHTML='';
  const shuffledOptions = q.options.sort(() => Math.random()-0.5);
  shuffledOptions.forEach(option=>{
    const li = document.createElement('li');
    li.textContent = option;
    li.onclick = () => selectOption(option);
    optionsEl.appendChild(li);
  });
}

function selectOption(selected){
  if(selected === questions[currentQuestion].answer) score++;
  currentQuestion++;
  if(currentQuestion < questions.length){ loadQuestion(); }
  else{ showScore(); }
}

function showScore(){
  questionEl.style.display='none';
  optionsEl.style.display='none';
  scoreContainer.style.display='block';
  scoreEl.textContent = score;
  totalEl.textContent = questions.length;
}

playAgainBtn.onclick = () => {
  currentQuestion=0; score=0;
  scoreContainer.style.display='none';
  questionEl.style.display='block';
  optionsEl.style.display='block';
  loadQuestion();
};
</script>
</body>
</html>
